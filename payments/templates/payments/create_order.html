<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create Order</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        form { max-width: 400px; margin: auto; display: flex; flex-direction: column; gap: 15px; }
        label { font-weight: bold; }
        input, select { padding: 8px; border-radius: 5px; border: 1px solid #ccc; }
        button { background: #28a745; color: white; padding: 10px; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #218838; }
        .success { color: green; font-weight: bold; text-align: center; }
        .error { color: red; font-weight: bold; text-align: center; }
    </style>
</head>
<body>
    <h1>Create PayPal Order</h1>

    <form method="post">
        {% csrf_token %}
        <input type="hidden" name="product_id" value="{{ product_id }}">

        <label for="name">Product Name (optional)</label>
        <input type="text" name="name" id="name" value="{{ product_name|default:'' }}">

        <label for="price">Price</label>
        <input type="text" name="price" id="price" required>

        <label for="currency">Currency</label>
        <select name="currency" id="currency">
            <option value="USD" {% if currency == "USD" %}selected{% endif %}>USD</option>
            <option value="EUR" {% if currency == "EUR" %}selected{% endif %}>EUR</option>
        </select>

        <button type="submit">Create Order</button>
    </form>

    {% if saved_price %}
        <p class="success">✅ Price saved in DB: {{ saved_price }}</p>
    {% endif %}

    {% if response %}
        {% if response.ok %}
            <p class="success">✅ Order created successfully!</p>
            <pre>{{ response.data|safe }}</pre>
        {% else %}
            <p class="error">❌ Failed: {{ response.error }}</p>
            <pre>{{ response.details }}</pre>
        {% endif %}
    {% endif %}

    {% if error %}
        <p class="error">{{ error }}</p>
    {% endif %}
</body>
</html>
